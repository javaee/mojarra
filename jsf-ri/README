This README documents the Sun Reference implementation (RI) for JSR 127,
JavaServer (tm) Faces.

jsf-api cvs tag for this implementation: JSF_API_20031110_BETA
jsf-api-spec for this implementation: <JSF_SPEC_PFD.pdf>

Installation Notes
==================

JavaServer (tm) Faces is intended to run in a Servlet 2.3, JSP 1.2 web
container, such as that distributed with Java Web Services Developer
Pack <http://java.sun.com/webservices/webservicespack.html>.  Please
follow the instructions for your container and have it working well in
your environment before continuing with these installation notes.

To use JavaServer (tm) Faces in your own webapp, you need to follow the
online documentation at <http://java.sun.com/j2ee/javaserverfaces/>.
Make sure to include all the jars in the lib directory of this
distribution in your WEB-INF/lib directory in your webapp.  

Major changes/features in this release:
=======================================

There have been a few significant changes since the Beta Relase of
JavaServer(tm) Faces Technology.

* The tag names for all tags in the jsf_core and html_basic TLDs have
  been changed to be CamelCase (http://en.wikipedia.org/wiki/CamelCase)
  with the first letter being lower case.  For example, <h:input_text>
  becomes <h:inputText>.  All attributes that are passed through to
  straight to the rendered markup are all lowercase, for example,
  <h:commandButton onblur="foo()" /> All attributes that are interpreted
  by the Renderer itself are CamelCase with the first letter being lower
  case.

* The names for the following entities in the application configuration
  resources file have changed to be prefixed with javax.faces to denote
  that these are reserved names:

  component-type, component-family, renderer-type, converter-id,
  validator-id

* Change how renderers are looked up.  Every component now has two
  properties to locate an appropriate Renderer: componentFamily, and
  rendererType.  This change allows a clean separation for components
  that can have multiple renderer types, such as UICommand with Link or
  Button renderers, or renderer types that can handle multiple
  components, such as the text renderer rendering UIOutput or UIInput
  components.  The signature for RenderKit.getRenderer() has changed.


  Please see the javadocs for more information.

* As with the objects created by the FacesFactory, now the following
  objects that can be over-ridden in the <application> element can take
  advantage of the decorator pattern to allow your custom implementation
  to have access to the implementation previously filling that role:

  action-listener, navigation-handler, view-handler, state-manager,
  property-resolver, variable-resolver

  In order to take advantage of this facility, your custom
  implementation must have a public constructor that takes the
  appropriate class you are trying to override.

* the render-kit-id for the default RenderKit is now HTML_BASIC

* The Standard HTML RenderKit specification is now documented.  Please
  see the "renderkitdocs" directory in the binary distribution.

* Support for an app to use a non standard render-kit.

  default-render-kit-id is an optional sub-element of the <application>
  element.  Setting this element in your application configuration
  resources file will cause your RenderKit to be used instead of the
  HTML_BASIC render-kit.  This change caused several changes in methods
  in ViewHandler and StateManager.  Please see the javadocs for details.

  The "renderKitId" attribute has been removed from the <f:view> tag.

* a validator signals that validation has failed by throwning an
  ValidationException.  Also, the signature for Validator.validate() has
  changed.

  Please see the javadocs for more information.

* Changes in value handling, validation, and timing of Conversion

  Please see section 2.5.1 for a brief holistic description of this
  process.  Note that This change only impacts faces implementation
  providers and advanced custom component authors.  This changes is
  transparent to page authors.

  Remove the class ConvertibleValueHolder.  Note that anything that has
  a value that could possibly be interesting to the model tier is liable
  for conversion.  Thus, the notion of having a converter has been moved
  up to the root ValueHolder interface.

  Introduce interface EditableValueHolder extends ValueHolder.  This
  defines the contract for things that are have values that can be
  changed by the user.  As such, it supports listeners and validators.

* The "method" and "action" attributes have been removed from <h:form>
  since their values must be constrained by the implementation.

* The "onclick" attribute has been removed from <h:commandLink>, since
  the renderer generates this attribute to allow the component to look
  like a hyperlink, but function like a button.

* Allowing mixed literals and EL in a JSF EL expression.  Allow full JSP
  2.0 eval syntax and operators in JSF EL.

* JSF has been tested and is know to work with Tiles.

* ValueBinding instances are no longer cached in the application.  This
  means Application.getValueBinding() has been replaced with
  Application.createValueBinding().

* If the setId() method has manually been called on the component, the renderer
  will generate an "id" attribute in the rendered markup, the value of
  which is obtained from the getClientId() method on the component.

* UICommand doesn't add the default ActionListener to itself, it just
  calls Application.getActionListener().

* When using <f:loadBundle> trying to access a resource that happens to
  be missing from the ResourceBundle yields ???key???.

* UIMessage changes

    UIMessages no longer has a "for" property

    The default values for showSummary and showDetail for UIMessage and
    UIMessages are as follows:

                    UIMessage     UIMessages
      showSummary     false         true
      showDetail      true          false

    This flips the defaults for UIMessage, and means that if you use
    UIMessages up top and UIMessage next to the component, you'll get a
    summary of all error messages up top, and detailed explanations
    below.

    Modified FacesMessage such that the "detail" property will be the
    same as the "summary" property unless it was set to something
    explicitly different.  

* StateManager is now a property of the Application, rather than the
  RenderKit.  It also can be configurable in the faces-config.xml

Logging support and configuration steps
=======================================
JavaServer Faces Reference Implementation in this release leverages the 
Jakarta Commons logging API to provide logging functionality. We have followed 
the guidelines recommended by 
http://jakarta.apache.org/commons/logging/userguide.html.
JavaServer Faces Reference Implementation can be configured to provide
logging information using the steps below.

step 1.
If you are using Tomcat or JWSDP as your container, you can set the following 
property to tell the container what logging implementation you are using
as well as the location of your logging configuration file. 
set CATALINA_OPTS=-Dorg.apache.commons.logging.Log=org.apache.commons.logging.impl.Jdk14Logger -Djava.util.logging.config.file=D:\Files_2k\j2sdk1.4.1_03\jre\lib\jsf-log.properties

step 2.
We have shown a sample logging configuration file below that is configured to
get logging output when you are running a JavaServer Faces application. 
The default JDK 1.4 logging configuration file is 
"$JAVA_HOME}/jre/lib/logging.properties". You can either manipulate that as per
directions below, in which case it's global to all Java apps that you run
or you can create a jsf.log properties as illustrated below. You can change 
the "java.util.logging.FileHandler.pattern" property to control
where your logging information is written.

Here's the jsf-log.properties
############################################################
#  	Default Logging Configuration File
# http://java.sun.com/j2se/1.4.2/docs/guide/util/logging/overview.html#1.2
# You can use a different file by specifying a filename
# with the java.util.logging.config.file system property.  
# For example java -Djava.util.logging.config.file=myfile
############################################################

############################################################
#  	Global properties
############################################################

# "handlers" specifies a comma separated list of log Handler 
# classes.  These handlers will be installed during VM startup.
# Note that these classes must be on the system classpath.
# By default we only configure a ConsoleHandler, which will only
# show messages at the INFO and above levels.

# To also add the FileHandler, use the following line instead.
handlers= java.util.logging.FileHandler, java.util.logging.ConsoleHandler

# Default global logging level.
# This specifies which kinds of events are logged across
# all loggers.  For any given facility this global level
# can be overriden by a facility specific level
# Note that the ConsoleHandler also has a separate level
# setting to limit messages printed to the console.
#.level= INFO
.level= INFO

############################################################
# Handler specific properties.
# Describes specific configuration info for Handlers.
############################################################

# default file output is in user's home directory.
java.util.logging.FileHandler.pattern = %h/java%u.log
java.util.logging.FileHandler.limit = 50000
java.util.logging.FileHandler.count = 1
java.util.logging.FileHandler.formatter = java.util.logging.XMLFormatter

# Limit the message that are printed on the console to INFO and above.
java.util.logging.ConsoleHandler.level = INFO
java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter


############################################################
# Facility specific properties.
# Provides extra control for each logger.
############################################################

# For example, set the com.xyz.foo logger to only log SEVERE
# messages:
com.xyz.foo.level = SEVERE
com.sun.faces.level = ALL

If you use the ConsoleHandler ( which would direct all the output to catalina.out 
in the case of standalone Tomcat or launcher.server.log in the case of JWSDP )
please make sure that the detail level for ConsoleHandler can handle the level set
for individual packages. For example say you have set the level for 
"com.sun.faces.el" package to "FINEST" as below.
    "com.sun.faces.el.level = FINEST"

You won't see any trace or debug messages unless you also set 
ConsoleHandler.level = FINEST. ConsoleHandler.level caps the detail level to the 
console, no matter what the underlying loggers are set for.

In this release, the Reference Implementation provides logging support for the
following packges.
    * com.sun.faces.application
    * com.sun.faces.el
    * com.sun.faces.lifecycle

The logging messages are not localized. Localisation as 
well as logging for rest of the RI will be done in a future release.

Known Issues With This Release
==============================

* When authoring a page that uses a UISelectOne component that is backed
  by a value reference expression that points to a primitive type, a
  default selected value default selected value must be included in the
  configured values for the component.  This is because there is no way
  to express "null" using primitive values.  Remember, you can't use "0"
  to express null, because "0" is a valid value.

* the value of javax.faces.component.NamingContainer.SEPARATOR_CHAR is
  ':'.  This means that the client id for components will be something
  like "form:checkbox1".  The use of the ':' character in the id causes
  problems for CSS stylesheets that try to apply style to components
  using their id.  The workaround is to use the CSS "class" concept to
  apply style to a component.

* When saving state on the server, there is no way for the server to
  know that a view has expired.  Thus, if the JSP page changes between
  requests, it's possible there will be inconsistencies between the
  restored tree and the JSP page.  Therefore, if you change the JSP
  page, you need to re-start the browser so that the session is lost.

  In related news, the number of views saved in the session when the
  application is configured to save state in the server is configurable
  by the RI init context parameter
  "com.sun.faces.NUMBER_OF_VIEWS_IN_SESSION" without quotes.  This is a
  non-standard feature, so don't count on it.

* Don't use the '.' character in ResourceBundle keys for use in Faces.
  This character is a reserved character in the JSF EL.

* When deploying on a non-JWSDP container, you must include all the
  dependent jars in your webapp's WEB-INF/lib directory.  It's possible
  it may work without doing this, but this is not a supported
  configuration.

* If you're using a tomcat 4 series container, you must use JSTL 1.0
  instead of JSTL 1.1.

* UIData children that do not use VB expressions fail to maintain their
  values.  In other words, if you have a literal value in a child of a
  UIData component, that value will be lost on postback.  Workaround:
  always use a VB expression with the value attribute for UIData
  children.

* UIComponent.broadcast() fails to throw IllegalStateException if passed
  invalid Parameter.

  From the javadocs of UIComponent.broadcast():

  <quote> java.lang.IllegalStateException - if PhaseId.ANY_PHASE is
  passed for the phase identifier </quote>

  No exception is currently thrown by the RI.

* The non-jsp demo does not deploy under tomcat 4.1.29.  

* Some web containers don't follow the Servlet 2.3 Spec rule of calling
  ServletContextListeners listeners defined in tld files in the META-INF
  directory of a jar. Running a faces webapp in such a container
  requires you to manually declare the ServletContextListener.  The
  listener-class you need to specify is

  com.sun.faces.config.ConfigureListener



Legal Notice
============

Copyright © 2002 Sun Microsystems, Inc., 4150 Network Circle, Santa
Clara, California 95054, U.S.A. All rights reserved.

Sun Microsystems, Inc. has intellectual property rights relating to
technology embodied in this product. In particular, and without
limitation, these intellectual property rights may include one or more
of the U.S. patents listed at http://www.sun.com/patents and one or more
additional patents or pending patent applications in the U.S. and other
countries.

This product is distributed under licenses restricting its use, copying
distribution, and decompilation. No part of this product may be
reproduced in any form by any means without prior written authorization
of Sun and its licensors, if any.

Third-party software, including font technology, is copyrighted and
licensed from Sun suppliers.

Sun, Sun Microsystems, the Sun logo, the Java Coffee Cup logo,
JavaServer, and Java are trademarks or registered trademarks of Sun
Microsystems, Inc. in the U.S. and other countries.

Federal Acquisitions: Commercial Software - Government Users Subject to
Standard License Terms and Conditions.

-----------------------------------------------------------------------

Copyright © 2002 Sun Microsystems, Inc., 4150 Network Circle,
Santa Clara, California 95054, Etats-Unis. Tous droits réservés.

Sun Microsystems, Inc. a les droits de propriété intellectuels relatants
à la technologie incorporée dans ce produit. En particulier, et sans la
limitation, ces droits de propriété intellectuels peuvent inclure un ou
plus des brevets américains énumérés à http://www.sun.com/patents et un
ou les brevets plus supplémentaires ou les applications de brevet en
attente dans les Etats - Unis et les autres pays.

Ce produit ou document est protégé par un copyright et distribué avec
des licences qui en restreignent l'utilisation, la copie, la
distribution, et la décompilation. Aucune partie de ce produit ou
document ne peut être reproduite sous aucune forme, par quelque moyen
que ce soit, sans l'autorisation préalable et écrite de Sun et de ses
bailleurs de licence, s'il y ena.

Le logiciel détenu par des tiers, et qui comprend la technologie
relative aux polices de caractères, est protégé par un copyright et
licencié par des fournisseurs de Sun.

Sun, Sun Microsystems, le logo Sun, le logo Java Coffee Cup, JavaServer,
et Java sont des marques de fabrique ou des marques déposées de Sun
Microsystems, Inc. aux Etats-Unis et dans d'autres pays.
